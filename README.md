# MHServer

Сервер для домашнего использования, с целью замены [Google Drive](https://drive.google.com), [Yandex Disk](https://360.yandex.ru/disk/) и т.д.

## Системные требования
* Linux
* Systemd
* [MariaDB](https://mariadb.org/)
* 500+ MB ОЗУ

## Установка
1. Скачиваете последнюю версию [из списка релизов](https://github.com/braginantonev/mhserver/releases)
2. Распаковываете архив: `tar -xzvf путь_до_архива/mhserver.tar.gz`
3. Переходите в каталог со скриптом настройки: `cd mhserver/scripts`
4. Настраивайте сервер: `./setup.sh`

> [!NOTE]
> Для понимания аспектов настройки, используйте информацию из раздела [Общая информация](#общая-информация).
>
> После настройки, при желании, вы можете удалить скачанный каталог с архивом.

## Использование
В конце настройки, вам будет предложено запустить сервис сервера. Если вы согласитесь, то сервер будет автоматически запускаться при старте системы.

Если вы отказались, то включить сервис вы можете в ручную в любое время: `sudo systemctl enable mhserver.service`

Если вы желаете запустить сервер с помощью исполняемого файла:
1. Переходите в каталог с исполняемым файлом `cd /opt/mhserver/`
2. * Для запуска всего (main & subservers): `sudo ./main`
   * Для запуска только основного сервера (main): `sudo ./main -M`
   * Для запуска только подсерверов (subservers): `sudo ./main -S`

## Общая информация

`Workspace path` &mdash; место в котором будут сохраняться файлы сервисов (файлового, музыкального и т.д.). Соответственно, это то место, где вы будете хранить свои файлы

`Server database password` &mdash; пароль для базы данных сервера. В ней хранятся учётные данные пользователей и т.д.

`Available server RAM percentage` &mdash; размер (в процентах) оперативной памяти доступный для сервера. Рекомендую устанавливать значение не больше 90

`SubServers` &mdash; главный функционал вашего сервера. Есть несколько типов:
1. Main сервер. Основной сервер, координирующий другие. Если он отключён... отключён весь функционал.
2. Files сервер. Используется для сохранения файлов.

> [!IMPORTANT]
> Файловый сервер является необходимым для работы остальных субсерверов.

3. Music сервер. Используется для сохранения и прослушивания музыки (дальнейший функционал в стадии размышлений)
4. Images сервер. Используется для сохранения и просмотра изображений.
5. LLM сервер. Используется для общения с ИИ-агентами.

Список готовых подсерверов:
|Subserver|available|
|---------|---------|
|Main     |✔️       |
|Files    |✔️       |
|Music    |❌       |
|Images   |❌       |
|LLM      |❌       |

> [!IMPORTANT]
> Выставляйте разные порты подсерверами, если они работают на одном адресе.

## API
MHServer API доступен на [вики](https://github.com/braginantonev/mhserver/wiki/API)

> [!WARNING]
> Использование API сервера, очень трудно для работы "из коробки" (с помощью curl или postman), т.к. сервер предусматривает использование больших файлов.
> Клиент находится на стадии разработки, однако можно сделать легкий клиент самостоятельно.

## FAQ
### Как продлить TLS или корневой сертификат, если они просрочены?
Вы можете воспользоваться скриптом настройки сертификата:
1. Перейдите в каталог с исполняемым файлом сервера: `cd /opt/mhserver`
2. Запустите скрипт: `./create-ssl-cert.sh`

> [!NOTE]
> Вы также можете использовать данный скрипт для просмотра срока жизни вашего сертификата.

